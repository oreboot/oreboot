use std::{fs, io};

extern crate uefi;
use uefi::*;

/// This test parses every fsp image from https://github.com/intel/FSP.
#[test]
fn parse_fsp() -> io::Result<()> {
    use std::path::Path;

    struct TestCase<'a> {
        path: &'a Path,
        expected_sections_and_sizes: &'a [(SectionInfo, usize)],
    };

    let test_cases = &[
        TestCase {
            path: Path::new("../../../3rdparty/fsp/AmberLakeFspBinPkg/Fsp.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x100, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x118, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x100, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x11c, sec_type: 0x12 }, 0x440),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1198, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x11b0, sec_type: 0x1b }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1198, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x11fc, sec_type: 0x12 }, 0x1f80),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1198, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x3180, sec_type: 0x15 }, 0xe),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1198, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x3194, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x31a8, ffs_guid: GUID(0xd144e214, 0xc547, 0x4bc7, [0xad, 0x3, 0xab, 0x4a, 0xf1, 0x5a, 0x32, 0xef]), ffs_type: 0x6, sec_base: 0x31c0, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x31a8, ffs_guid: GUID(0xd144e214, 0xc547, 0x4bc7, [0xad, 0x3, 0xab, 0x4a, 0xf1, 0x5a, 0x32, 0xef]), ffs_type: 0x6, sec_base: 0x31e8, sec_type: 0x1 }, 0x14ad5),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x17cc8, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x17ce0, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x17cc8, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x17d1c, sec_type: 0x1 }, 0x1dfe),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x19b20, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x19b38, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x19b20, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x19b60, sec_type: 0x1 }, 0x391),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x19ef8, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x19f10, sec_type: 0x1 }, 0x6f23),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x20e38, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x20e50, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x20e38, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x20e78, sec_type: 0x1 }, 0x37f2),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24670, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x24688, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24670, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x246c4, sec_type: 0x1 }, 0x2d9),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x249a8, ffs_guid: GUID(0x5aa5031e, 0x4cb6, 0x43d4, [0xb2, 0x19, 0xfe, 0x50, 0xff, 0x5d, 0x11, 0x6c]), ffs_type: 0x6, sec_base: 0x249c0, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x249a8, ffs_guid: GUID(0x5aa5031e, 0x4cb6, 0x43d4, [0xb2, 0x19, 0xfe, 0x50, 0xff, 0x5d, 0x11, 0x6c]), ffs_type: 0x6, sec_base: 0x249fc, sec_type: 0x1 }, 0xbaa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x255b0, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x255c8, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x255b0, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x25604, sec_type: 0x1 }, 0x135f),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x26968, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x26980, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x26968, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x269bc, sec_type: 0x1 }, 0x446),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x26e08, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x26e20, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x26e08, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x26e48, sec_type: 0x12 }, 0x3c0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x26e08, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x2720c, sec_type: 0x15 }, 0x18),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x26e08, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x27228, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x27238, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x27250, sec_type: 0x1b }, 0x37),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x27238, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x2728c, sec_type: 0x1 }, 0x17d),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x27410, ffs_guid: GUID(0x7e26f49b, 0xd7c4, 0x4693, [0xa5, 0x75, 0x3c, 0xb, 0x4c, 0xcc, 0x5e, 0x6e]), ffs_type: 0x7, sec_base: 0x27428, sec_type: 0x13 }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x27410, ffs_guid: GUID(0x7e26f49b, 0xd7c4, 0x4693, [0xa5, 0x75, 0x3c, 0xb, 0x4c, 0xcc, 0x5e, 0x6e]), ffs_type: 0x7, sec_base: 0x27450, sec_type: 0x1 }, 0xb23),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x27f78, ffs_guid: GUID(0xa6ff9fec, 0xcf, 0x4577, [0xbc, 0x4b, 0xb3, 0xb3, 0x15, 0x0, 0x5c, 0xff]), ffs_type: 0x7, sec_base: 0x27f90, sec_type: 0x13 }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x27f78, ffs_guid: GUID(0xa6ff9fec, 0xcf, 0x4577, [0xbc, 0x4b, 0xb3, 0xb3, 0x15, 0x0, 0x5c, 0xff]), ffs_type: 0x7, sec_base: 0x27fcc, sec_type: 0x1 }, 0x1e3f),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x29e10, ffs_guid: GUID(0xef216a7e, 0x73bc, 0x4cb6, [0xb2, 0xe9, 0x54, 0x80, 0x1c, 0x84, 0xb1, 0x6b]), ffs_type: 0x7, sec_base: 0x29e28, sec_type: 0x13 }, 0x7e),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x29e10, ffs_guid: GUID(0xef216a7e, 0x73bc, 0x4cb6, [0xb2, 0xe9, 0x54, 0x80, 0x1c, 0x84, 0xb1, 0x6b]), ffs_type: 0x7, sec_base: 0x29eac, sec_type: 0x1 }, 0x3c3),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x2e100, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x2e118, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x2e100, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x2e11c, sec_type: 0x12 }, 0x980),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x2eaa0, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x2eab8, sec_type: 0x12 }, 0x5660),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x2eaa0, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x3411c, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x2eaa0, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x34130, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34140, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x34158, sec_type: 0x19 }, 0x128),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34140, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x34284, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34140, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3429c, sec_type: 0x12 }, 0x1760),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34140, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x35a00, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34140, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x35a14, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x35a28, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x35a40, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x35a28, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x35a58, sec_type: 0x12 }, 0x560),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x35a28, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x35fbc, sec_type: 0x15 }, 0x2a),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x35a28, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x35fec, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x36000, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x36018, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x36000, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x36040, sec_type: 0x12 }, 0x2a0),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x36000, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x362e4, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x36000, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x36300, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x36310, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x36328, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x36310, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x36340, sec_type: 0x12 }, 0x57220),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x36310, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x8d564, sec_type: 0x15 }, 0x20),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x36310, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x8d588, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x8d598, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x8d5b0, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x8d598, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x8d5d8, sec_type: 0x12 }, 0x2370),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x8d598, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x8f94c, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x8d598, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x8f96c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x94000, ffs_base: 0x94100, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0x94118, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x94000, ffs_base: 0x94100, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0x9411c, sec_type: 0x12 }, 0x21d0),
            ],
        },
        TestCase {
            path: Path::new("../../../3rdparty/fsp/ApolloLakeFspBinPkg/FspBin/Fsp.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x4d8, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x4f0, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x4d8, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x4f4, sec_type: 0x12 }, 0x270),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x768, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x780, sec_type: 0x1b }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x768, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x7cc, sec_type: 0x12 }, 0x1950),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x768, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x2120, sec_type: 0x15 }, 0xe),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x768, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x2134, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2148, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x2160, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2148, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x2188, sec_type: 0x1 }, 0x2f0b),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x5098, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x50b0, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x5098, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x50ec, sec_type: 0x1 }, 0xaa73),
                (SectionInfo { fv_base: 0x0, ffs_base: 0xfb68, ffs_guid: GUID(0xba37f2c5, 0xb0f3, 0x4a95, [0xb5, 0x5f, 0xf2, 0x5f, 0x4f, 0x6f, 0x84, 0x52]), ffs_type: 0x6, sec_base: 0xfb80, sec_type: 0x1 }, 0x7970),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x174f8, ffs_guid: GUID(0xde23acee, 0xcf55, 0x4fb6, [0xaa, 0x77, 0x98, 0x4a, 0xb5, 0x3d, 0xe8, 0x23]), ffs_type: 0x6, sec_base: 0x17510, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x174f8, ffs_guid: GUID(0xde23acee, 0xcf55, 0x4fb6, [0xaa, 0x77, 0x98, 0x4a, 0xb5, 0x3d, 0xe8, 0x23]), ffs_type: 0x6, sec_base: 0x17528, sec_type: 0x1 }, 0x1350),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x18880, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x18898, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x18880, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x188c0, sec_type: 0x1 }, 0x368),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x2b328, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x2b340, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x2b328, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x2b344, sec_type: 0x12 }, 0x708),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x2ba50, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x2ba68, sec_type: 0x12 }, 0x4b58),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x2ba50, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x305c4, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x2ba50, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x305d8, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x305e8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x30600, sec_type: 0x19 }, 0x78),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x305e8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3067c, sec_type: 0x1b }, 0x2),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x305e8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x30684, sec_type: 0x12 }, 0x1510),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x305e8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x31b98, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x305e8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x31bac, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x31bc0, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x31bd8, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x31bc0, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x31bf0, sec_type: 0x12 }, 0x6ed8),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x31bc0, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x38acc, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x31bc0, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x38aec, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x38b00, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x38b18, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x38b00, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x38b30, sec_type: 0x12 }, 0x2268),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x38b00, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3ad9c, sec_type: 0x15 }, 0x1a),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x38b00, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3adbc, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x3add0, ffs_guid: GUID(0x3381fc3f, 0x8791, 0x41e5, [0x88, 0x71, 0xa9, 0x60, 0xa4, 0xed, 0x24, 0xb7]), ffs_type: 0x6, sec_base: 0x3ade8, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x3add0, ffs_guid: GUID(0x3381fc3f, 0x8791, 0x41e5, [0x88, 0x71, 0xa9, 0x60, 0xa4, 0xed, 0x24, 0xb7]), ffs_type: 0x6, sec_base: 0x3ae00, sec_type: 0x12 }, 0x32a40),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x3add0, ffs_guid: GUID(0x3381fc3f, 0x8791, 0x41e5, [0x88, 0x71, 0xa9, 0x60, 0xa4, 0xed, 0x24, 0xb7]), ffs_type: 0x6, sec_base: 0x6d844, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x2b000, ffs_base: 0x3add0, ffs_guid: GUID(0x3381fc3f, 0x8791, 0x41e5, [0x88, 0x71, 0xa9, 0x60, 0xa4, 0xed, 0x24, 0xb7]), ffs_type: 0x6, sec_base: 0x6d860, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x84000, ffs_base: 0x84180, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0x84198, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x84000, ffs_base: 0x84180, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0x8419c, sec_type: 0x12 }, 0x9d0),
            ],
        },
        TestCase {
            path: Path::new("../../../3rdparty/fsp/BraswellFspBinPkg/FspBin/BSWFSP.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x110, ffs_guid: GUID(0x6803c250, 0x6222, 0x4eaa, [0xb1, 0x64, 0xd, 0x24, 0x60, 0xac, 0xb8, 0xe2]), ffs_type: 0x6, sec_base: 0x128, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x110, ffs_guid: GUID(0x6803c250, 0x6222, 0x4eaa, [0xb1, 0x64, 0xd, 0x24, 0x60, 0xac, 0xb8, 0xe2]), ffs_type: 0x6, sec_base: 0x140, sec_type: 0x12 }, 0x658),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x110, ffs_guid: GUID(0x6803c250, 0x6222, 0x4eaa, [0xb1, 0x64, 0xd, 0x24, 0x60, 0xac, 0xb8, 0xe2]), ffs_type: 0x6, sec_base: 0x79c, sec_type: 0x15 }, 0x20),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x110, ffs_guid: GUID(0x6803c250, 0x6222, 0x4eaa, [0xb1, 0x64, 0xd, 0x24, 0x60, 0xac, 0xb8, 0xe2]), ffs_type: 0x6, sec_base: 0x7c0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x7d0, ffs_guid: GUID(0xb494df39, 0xa5f8, 0x48a1, [0xb2, 0xd0, 0xef, 0x52, 0x3a, 0xd9, 0x1c, 0x55]), ffs_type: 0x6, sec_base: 0x7e8, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x7d0, ffs_guid: GUID(0xb494df39, 0xa5f8, 0x48a1, [0xb2, 0xd0, 0xef, 0x52, 0x3a, 0xd9, 0x1c, 0x55]), ffs_type: 0x6, sec_base: 0x800, sec_type: 0x12 }, 0x9b8),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x7d0, ffs_guid: GUID(0xb494df39, 0xa5f8, 0x48a1, [0xb2, 0xd0, 0xef, 0x52, 0x3a, 0xd9, 0x1c, 0x55]), ffs_type: 0x6, sec_base: 0x11bc, sec_type: 0x15 }, 0x22),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x7d0, ffs_guid: GUID(0xb494df39, 0xa5f8, 0x48a1, [0xb2, 0xd0, 0xef, 0x52, 0x3a, 0xd9, 0x1c, 0x55]), ffs_type: 0x6, sec_base: 0x11e4, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x11f8, ffs_guid: GUID(0xfd236ae7, 0x791, 0x48c4, [0xb2, 0x9e, 0x29, 0xbd, 0xee, 0xe1, 0xa8, 0x38]), ffs_type: 0x6, sec_base: 0x1210, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x11f8, ffs_guid: GUID(0xfd236ae7, 0x791, 0x48c4, [0xb2, 0x9e, 0x29, 0xbd, 0xee, 0xe1, 0xa8, 0x38]), ffs_type: 0x6, sec_base: 0x1238, sec_type: 0x12 }, 0x10a48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x11f8, ffs_guid: GUID(0xfd236ae7, 0x791, 0x48c4, [0xb2, 0x9e, 0x29, 0xbd, 0xee, 0xe1, 0xa8, 0x38]), ffs_type: 0x6, sec_base: 0x11c84, sec_type: 0x15 }, 0x18),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x11f8, ffs_guid: GUID(0xfd236ae7, 0x791, 0x48c4, [0xb2, 0x9e, 0x29, 0xbd, 0xee, 0xe1, 0xa8, 0x38]), ffs_type: 0x6, sec_base: 0x11ca0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x11cb0, ffs_guid: GUID(0x1359d99, 0x9446, 0x456d, [0xad, 0xa4, 0x50, 0xa7, 0x11, 0xc0, 0x3a, 0xdb]), ffs_type: 0x6, sec_base: 0x11cc8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x11cb0, ffs_guid: GUID(0x1359d99, 0x9446, 0x456d, [0xad, 0xa4, 0x50, 0xa7, 0x11, 0xc0, 0x3a, 0xdb]), ffs_type: 0x6, sec_base: 0x11cf0, sec_type: 0x12 }, 0x17f8),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x11cb0, ffs_guid: GUID(0x1359d99, 0x9446, 0x456d, [0xad, 0xa4, 0x50, 0xa7, 0x11, 0xc0, 0x3a, 0xdb]), ffs_type: 0x6, sec_base: 0x134ec, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x11cb0, ffs_guid: GUID(0x1359d99, 0x9446, 0x456d, [0xad, 0xa4, 0x50, 0xa7, 0x11, 0xc0, 0x3a, 0xdb]), ffs_type: 0x6, sec_base: 0x13500, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x13510, ffs_guid: GUID(0x24169e35, 0x2454, 0x4940, [0x92, 0xbc, 0x82, 0x32, 0x1a, 0x2c, 0x75, 0x62]), ffs_type: 0x6, sec_base: 0x13528, sec_type: 0x1b }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x13510, ffs_guid: GUID(0x24169e35, 0x2454, 0x4940, [0x92, 0xbc, 0x82, 0x32, 0x1a, 0x2c, 0x75, 0x62]), ffs_type: 0x6, sec_base: 0x13574, sec_type: 0x12 }, 0x1a08),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x13510, ffs_guid: GUID(0x24169e35, 0x2454, 0x4940, [0x92, 0xbc, 0x82, 0x32, 0x1a, 0x2c, 0x75, 0x62]), ffs_type: 0x6, sec_base: 0x14f80, sec_type: 0x15 }, 0x18),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x13510, ffs_guid: GUID(0x24169e35, 0x2454, 0x4940, [0x92, 0xbc, 0x82, 0x32, 0x1a, 0x2c, 0x75, 0x62]), ffs_type: 0x6, sec_base: 0x14f9c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x14fb0, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x14fc8, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x14fb0, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x14fe0, sec_type: 0x12 }, 0x7b0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x14fb0, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x15794, sec_type: 0x15 }, 0x38),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x14fb0, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x157d0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x157e0, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x157f8, sec_type: 0x10 }, 0xb4e0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x157e0, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x20cdc, sec_type: 0x15 }, 0x2e),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x20d10, ffs_guid: GUID(0x8aeeb956, 0x93c0, 0x49d9, [0xbf, 0x82, 0xfc, 0x34, 0x9c, 0xab, 0x57, 0xb9]), ffs_type: 0x6, sec_base: 0x20d28, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x20d10, ffs_guid: GUID(0x8aeeb956, 0x93c0, 0x49d9, [0xbf, 0x82, 0xfc, 0x34, 0x9c, 0xab, 0x57, 0xb9]), ffs_type: 0x6, sec_base: 0x20d40, sec_type: 0x12 }, 0x1a78),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x20d10, ffs_guid: GUID(0x8aeeb956, 0x93c0, 0x49d9, [0xbf, 0x82, 0xfc, 0x34, 0x9c, 0xab, 0x57, 0xb9]), ffs_type: 0x6, sec_base: 0x227bc, sec_type: 0x15 }, 0x22),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x20d10, ffs_guid: GUID(0x8aeeb956, 0x93c0, 0x49d9, [0xbf, 0x82, 0xfc, 0x34, 0x9c, 0xab, 0x57, 0xb9]), ffs_type: 0x6, sec_base: 0x227e4, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x227f8, ffs_guid: GUID(0x93c81a74, 0xb648, 0x4f7f, [0x92, 0x5e, 0xe4, 0xa0, 0xcd, 0xcc, 0x77, 0x6d]), ffs_type: 0x6, sec_base: 0x22810, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x227f8, ffs_guid: GUID(0x93c81a74, 0xb648, 0x4f7f, [0x92, 0x5e, 0xe4, 0xa0, 0xcd, 0xcc, 0x77, 0x6d]), ffs_type: 0x6, sec_base: 0x22838, sec_type: 0x12 }, 0x2230),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x227f8, ffs_guid: GUID(0x93c81a74, 0xb648, 0x4f7f, [0x92, 0x5e, 0xe4, 0xa0, 0xcd, 0xcc, 0x77, 0x6d]), ffs_type: 0x6, sec_base: 0x24a6c, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x227f8, ffs_guid: GUID(0x93c81a74, 0xb648, 0x4f7f, [0x92, 0x5e, 0xe4, 0xa0, 0xcd, 0xcc, 0x77, 0x6d]), ffs_type: 0x6, sec_base: 0x24a88, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24a98, ffs_guid: GUID(0x98c8588c, 0x640a, 0x4bb4, [0xae, 0xa0, 0x3f, 0x81, 0xcd, 0xe1, 0x75, 0x24]), ffs_type: 0x6, sec_base: 0x24ab0, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24a98, ffs_guid: GUID(0x98c8588c, 0x640a, 0x4bb4, [0xae, 0xa0, 0x3f, 0x81, 0xcd, 0xe1, 0x75, 0x24]), ffs_type: 0x6, sec_base: 0x24aec, sec_type: 0x12 }, 0x1150),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24a98, ffs_guid: GUID(0x98c8588c, 0x640a, 0x4bb4, [0xae, 0xa0, 0x3f, 0x81, 0xcd, 0xe1, 0x75, 0x24]), ffs_type: 0x6, sec_base: 0x25c40, sec_type: 0x15 }, 0x14),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24a98, ffs_guid: GUID(0x98c8588c, 0x640a, 0x4bb4, [0xae, 0xa0, 0x3f, 0x81, 0xcd, 0xe1, 0x75, 0x24]), ffs_type: 0x6, sec_base: 0x25c58, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x25c68, ffs_guid: GUID(0x4d1f48d8, 0x498, 0x4c09, [0x8e, 0xde, 0x72, 0xf3, 0xb, 0x58, 0xb1, 0xf2]), ffs_type: 0x6, sec_base: 0x25c80, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x25c68, ffs_guid: GUID(0x4d1f48d8, 0x498, 0x4c09, [0x8e, 0xde, 0x72, 0xf3, 0xb, 0x58, 0xb1, 0xf2]), ffs_type: 0x6, sec_base: 0x25c98, sec_type: 0x1 }, 0xb53),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x267f0, ffs_guid: GUID(0x47ea2673, 0x2533, 0x4c07, [0xaa, 0xba, 0x69, 0xce, 0x5a, 0x7c, 0x5d, 0x35]), ffs_type: 0x6, sec_base: 0x26808, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x267f0, ffs_guid: GUID(0x47ea2673, 0x2533, 0x4c07, [0xaa, 0xba, 0x69, 0xce, 0x5a, 0x7c, 0x5d, 0x35]), ffs_type: 0x6, sec_base: 0x26820, sec_type: 0x12 }, 0xa88),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x267f0, ffs_guid: GUID(0x47ea2673, 0x2533, 0x4c07, [0xaa, 0xba, 0x69, 0xce, 0x5a, 0x7c, 0x5d, 0x35]), ffs_type: 0x6, sec_base: 0x272ac, sec_type: 0x15 }, 0x22),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x267f0, ffs_guid: GUID(0x47ea2673, 0x2533, 0x4c07, [0xaa, 0xba, 0x69, 0xce, 0x5a, 0x7c, 0x5d, 0x35]), ffs_type: 0x6, sec_base: 0x272d4, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x272e8, ffs_guid: GUID(0xde23acee, 0xcf55, 0x4fb6, [0xaa, 0x77, 0x98, 0x4a, 0xb5, 0x3d, 0xe8, 0x23]), ffs_type: 0x6, sec_base: 0x27300, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x272e8, ffs_guid: GUID(0xde23acee, 0xcf55, 0x4fb6, [0xaa, 0x77, 0x98, 0x4a, 0xb5, 0x3d, 0xe8, 0x23]), ffs_type: 0x6, sec_base: 0x27328, sec_type: 0x12 }, 0x45b0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x272e8, ffs_guid: GUID(0xde23acee, 0xcf55, 0x4fb6, [0xaa, 0x77, 0x98, 0x4a, 0xb5, 0x3d, 0xe8, 0x23]), ffs_type: 0x6, sec_base: 0x2b8dc, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x272e8, ffs_guid: GUID(0xde23acee, 0xcf55, 0x4fb6, [0xaa, 0x77, 0x98, 0x4a, 0xb5, 0x3d, 0xe8, 0x23]), ffs_type: 0x6, sec_base: 0x2b8fc, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x30078, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x30090, sec_type: 0x12 }, 0x4a10),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x30078, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x34aa4, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x30078, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x34ab8, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x34ac8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x34ae0, sec_type: 0x19 }, 0x9a),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x34ac8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x34b80, sec_type: 0x1b }, 0x2),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x34ac8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x34b88, sec_type: 0x12 }, 0x1368),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x34ac8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x35ef4, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x34ac8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x35f08, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x35f18, ffs_guid: GUID(0x2aaf88f6, 0x4ab0, 0x415d, [0x96, 0xd, 0x44, 0xdb, 0xf, 0x38, 0x8, 0xac]), ffs_type: 0x6, sec_base: 0x35f30, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x35f18, ffs_guid: GUID(0x2aaf88f6, 0x4ab0, 0x415d, [0x96, 0xd, 0x44, 0xdb, 0xf, 0x38, 0x8, 0xac]), ffs_type: 0x6, sec_base: 0x35f48, sec_type: 0x12 }, 0x400),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x35f18, ffs_guid: GUID(0x2aaf88f6, 0x4ab0, 0x415d, [0x96, 0xd, 0x44, 0xdb, 0xf, 0x38, 0x8, 0xac]), ffs_type: 0x6, sec_base: 0x3634c, sec_type: 0x15 }, 0x28),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x35f18, ffs_guid: GUID(0x2aaf88f6, 0x4ab0, 0x415d, [0x96, 0xd, 0x44, 0xdb, 0xf, 0x38, 0x8, 0xac]), ffs_type: 0x6, sec_base: 0x36378, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x36388, ffs_guid: GUID(0x9618c0dc, 0x50a4, 0x496c, [0x99, 0x4f, 0x72, 0x41, 0xf2, 0x82, 0xed, 0x1]), ffs_type: 0x6, sec_base: 0x363a0, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x36388, ffs_guid: GUID(0x9618c0dc, 0x50a4, 0x496c, [0x99, 0x4f, 0x72, 0x41, 0xf2, 0x82, 0xed, 0x1]), ffs_type: 0x6, sec_base: 0x363b8, sec_type: 0x12 }, 0x1688),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x36388, ffs_guid: GUID(0x9618c0dc, 0x50a4, 0x496c, [0x99, 0x4f, 0x72, 0x41, 0xf2, 0x82, 0xed, 0x1]), ffs_type: 0x6, sec_base: 0x37a44, sec_type: 0x15 }, 0x24),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x36388, ffs_guid: GUID(0x9618c0dc, 0x50a4, 0x496c, [0x99, 0x4f, 0x72, 0x41, 0xf2, 0x82, 0xed, 0x1]), ffs_type: 0x6, sec_base: 0x37a6c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x37a80, ffs_guid: GUID(0xf9c17cdf, 0xc8a6, 0x488f, [0xb1, 0xb2, 0x24, 0x75, 0xcb, 0x6f, 0x26, 0xc0]), ffs_type: 0x6, sec_base: 0x37a98, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x37a80, ffs_guid: GUID(0xf9c17cdf, 0xc8a6, 0x488f, [0xb1, 0xb2, 0x24, 0x75, 0xcb, 0x6f, 0x26, 0xc0]), ffs_type: 0x6, sec_base: 0x37ac0, sec_type: 0x12 }, 0x318),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x37a80, ffs_guid: GUID(0xf9c17cdf, 0xc8a6, 0x488f, [0xb1, 0xb2, 0x24, 0x75, 0xcb, 0x6f, 0x26, 0xc0]), ffs_type: 0x6, sec_base: 0x37ddc, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x37a80, ffs_guid: GUID(0xf9c17cdf, 0xc8a6, 0x488f, [0xb1, 0xb2, 0x24, 0x75, 0xcb, 0x6f, 0x26, 0xc0]), ffs_type: 0x6, sec_base: 0x37dfc, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x37e10, ffs_guid: GUID(0xd4ee25ea, 0xb48, 0x43ae, [0xa0, 0x16, 0x4d, 0x6e, 0x8b, 0x6c, 0x43, 0xb3]), ffs_type: 0x6, sec_base: 0x37e28, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x37e10, ffs_guid: GUID(0xd4ee25ea, 0xb48, 0x43ae, [0xa0, 0x16, 0x4d, 0x6e, 0x8b, 0x6c, 0x43, 0xb3]), ffs_type: 0x6, sec_base: 0x37e50, sec_type: 0x12 }, 0x11058),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x37e10, ffs_guid: GUID(0xd4ee25ea, 0xb48, 0x43ae, [0xa0, 0x16, 0x4d, 0x6e, 0x8b, 0x6c, 0x43, 0xb3]), ffs_type: 0x6, sec_base: 0x48eac, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x37e10, ffs_guid: GUID(0xd4ee25ea, 0xb48, 0x43ae, [0xa0, 0x16, 0x4d, 0x6e, 0x8b, 0x6c, 0x43, 0xb3]), ffs_type: 0x6, sec_base: 0x48ec8, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x49848, ffs_guid: GUID(0x1ba0062e, 0xc779, 0x4582, [0x85, 0x66, 0x33, 0x6a, 0xe8, 0xf7, 0x8f, 0x9]), ffs_type: 0x3, sec_base: 0x49860, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x49848, ffs_guid: GUID(0x1ba0062e, 0xc779, 0x4582, [0x85, 0x66, 0x33, 0x6a, 0xe8, 0xf7, 0x8f, 0x9]), ffs_type: 0x3, sec_base: 0x49864, sec_type: 0x12 }, 0x1848),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x49848, ffs_guid: GUID(0x1ba0062e, 0xc779, 0x4582, [0x85, 0x66, 0x33, 0x6a, 0xe8, 0xf7, 0x8f, 0x9]), ffs_type: 0x3, sec_base: 0x4b0b0, sec_type: 0x19 }, 0x8),
                (SectionInfo { fv_base: 0x30000, ffs_base: 0x49848, ffs_guid: GUID(0x1ba0062e, 0xc779, 0x4582, [0x85, 0x66, 0x33, 0x6a, 0xe8, 0xf7, 0x8f, 0x9]), ffs_type: 0x3, sec_base: 0x4b0bc, sec_type: 0x19 }, 0x40),
            ],
        },
        TestCase {
            path: Path::new("../../../3rdparty/fsp/CoffeeLakeFspBinPkg/Fsp.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x134, sec_type: 0x12 }, 0x440),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x578, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x590, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x578, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x5cc, sec_type: 0x12 }, 0x1a80),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x578, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x2050, sec_type: 0x15 }, 0xe),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x578, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x2064, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2078, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x2090, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2078, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x20b8, sec_type: 0x1 }, 0x2fcc),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x5088, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x50a0, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x5088, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x50dc, sec_type: 0x1 }, 0x32a3),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x8388, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x83a0, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x8388, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x83dc, sec_type: 0x1 }, 0x1a3b5),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22798, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x227b0, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22798, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x227d8, sec_type: 0x1 }, 0x314),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22af0, ffs_guid: GUID(0x5aa5031e, 0x4cb6, 0x43d4, [0xb2, 0x19, 0xfe, 0x50, 0xff, 0x5d, 0x11, 0x6c]), ffs_type: 0x6, sec_base: 0x22b08, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22af0, ffs_guid: GUID(0x5aa5031e, 0x4cb6, 0x43d4, [0xb2, 0x19, 0xfe, 0x50, 0xff, 0x5d, 0x11, 0x6c]), ffs_type: 0x6, sec_base: 0x22b30, sec_type: 0x1 }, 0x983),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x234b8, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x234d0, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x234b8, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x234f8, sec_type: 0x1 }, 0x136c),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24868, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x24880, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24868, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x248a8, sec_type: 0x1 }, 0x430),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x25780, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x25798, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x25780, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x257b0, sec_type: 0x1 }, 0x47d),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x25c38, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x25c50, sec_type: 0x1 }, 0x6ef9),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x35118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x35130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x35118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x35134, sec_type: 0x12 }, 0x940),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x35a78, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x35a90, sec_type: 0x12 }, 0x4d20),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x35a78, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x3a7b4, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x35a78, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x3a7c8, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3a7d8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a7f0, sec_type: 0x19 }, 0xb0),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3a7d8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a8a4, sec_type: 0x1b }, 0x2),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3a7d8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a8ac, sec_type: 0x12 }, 0x16e0),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3a7d8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3bf90, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3a7d8, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3bfa4, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3bfb8, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3bfd0, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3bfb8, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3bff8, sec_type: 0x12 }, 0x2a0),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3bfb8, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3c29c, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3bfb8, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3c2b8, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3c2c8, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3c2e0, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3c2c8, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3c2f8, sec_type: 0x12 }, 0x54d08),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3c2c8, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x91004, sec_type: 0x15 }, 0x20),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x3c2c8, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x91028, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x91038, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x91050, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x91038, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x91068, sec_type: 0x12 }, 0x7d60),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x91038, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x98dcc, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x35000, ffs_base: 0x91038, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x98dec, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0xbd000, ffs_base: 0xbd118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xbd130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0xbd000, ffs_base: 0xbd118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xbd134, sec_type: 0x12 }, 0x3ce0),
            ],
        },
        TestCase {
            path: Path::new("../../../3rdparty/fsp/CometLakeFspBinPkg/CometLake1/Fsp.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x134, sec_type: 0x12 }, 0x440),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x1088, sec_type: 0x1b }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x10d4, sec_type: 0x12 }, 0x2200),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x32d8, sec_type: 0x15 }, 0xe),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x32ec, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x3300, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x3318, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x3300, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x3354, sec_type: 0x1 }, 0x18cbd),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1c018, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x1c030, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1c018, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x1c06c, sec_type: 0x1 }, 0x2307),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1e378, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x1e390, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1e378, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x1e3b8, sec_type: 0x1 }, 0x394b),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21d08, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x21d20, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21d08, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x21d5c, sec_type: 0x1 }, 0x2f8),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22058, ffs_guid: GUID(0xd3686f72, 0xb3dc, 0x4bb1, [0x84, 0x7b, 0xfb, 0x8d, 0xdc, 0xda, 0xf7, 0x9c]), ffs_type: 0x6, sec_base: 0x22070, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22058, ffs_guid: GUID(0xd3686f72, 0xb3dc, 0x4bb1, [0x84, 0x7b, 0xfb, 0x8d, 0xdc, 0xda, 0xf7, 0x9c]), ffs_type: 0x6, sec_base: 0x220ac, sec_type: 0x1 }, 0x94e),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22a00, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x22a18, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22a00, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x22a54, sec_type: 0x1 }, 0x128b),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23ce8, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x23d00, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23ce8, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x23d3c, sec_type: 0x1 }, 0x4bb),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24218, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24240, sec_type: 0x12 }, 0x3c0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24604, sec_type: 0x15 }, 0x18),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24620, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24630, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x24648, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24630, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x24670, sec_type: 0x1 }, 0x466),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24ae0, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x24af8, sec_type: 0x1 }, 0x709d),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bba0, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x2bbb8, sec_type: 0x1b }, 0x37),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bba0, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x2bbf4, sec_type: 0x1 }, 0x183),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bd80, ffs_guid: GUID(0xb8ba8298, 0xaf29, 0x4fa3, [0x9d, 0x10, 0x27, 0xa8, 0x47, 0x8b, 0xb6, 0xa7]), ffs_type: 0x7, sec_base: 0x2bd98, sec_type: 0x13 }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bd80, ffs_guid: GUID(0xb8ba8298, 0xaf29, 0x4fa3, [0x9d, 0x10, 0x27, 0xa8, 0x47, 0x8b, 0xb6, 0xa7]), ffs_type: 0x7, sec_base: 0x2bdd4, sec_type: 0x1 }, 0x13d5),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2d1b0, ffs_guid: GUID(0xc92652e3, 0xc7de, 0x4c78, [0x95, 0x77, 0x1c, 0x89, 0x7c, 0x51, 0xbf, 0xfa]), ffs_type: 0x7, sec_base: 0x2d1c8, sec_type: 0x13 }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2d1b0, ffs_guid: GUID(0xc92652e3, 0xc7de, 0x4c78, [0x95, 0x77, 0x1c, 0x89, 0x7c, 0x51, 0xbf, 0xfa]), ffs_type: 0x7, sec_base: 0x2d214, sec_type: 0x1 }, 0x20a6),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2f2c0, ffs_guid: GUID(0x1c652ec8, 0x2347, 0x44c1, [0x93, 0xe0, 0xd1, 0xbe, 0xe8, 0xc8, 0x2f, 0xfc]), ffs_type: 0x7, sec_base: 0x2f2d8, sec_type: 0x13 }, 0x7e),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2f2c0, ffs_guid: GUID(0x1c652ec8, 0x2347, 0x44c1, [0x93, 0xe0, 0xd1, 0xbe, 0xe8, 0xc8, 0x2f, 0xfc]), ffs_type: 0x7, sec_base: 0x2f35c, sec_type: 0x1 }, 0x9de),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x34130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x34134, sec_type: 0x12 }, 0x980),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x34ad0, sec_type: 0x12 }, 0x5860),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x3a334, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x3a348, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a370, sec_type: 0x19 }, 0x128),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a49c, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a4b4, sec_type: 0x12 }, 0x18a0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3bd58, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3bd6c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3bd98, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3bdb0, sec_type: 0x12 }, 0x1140),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3cef4, sec_type: 0x15 }, 0x2a),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3cf24, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3cf50, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3cf68, sec_type: 0x12 }, 0x940),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3d8ac, sec_type: 0x15 }, 0x1e),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3d8d0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3d8f8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3d920, sec_type: 0x12 }, 0x2a0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3dbc4, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3dbe0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3dc08, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3dc30, sec_type: 0x12 }, 0x59f50),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x97b84, sec_type: 0x15 }, 0x20),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x97ba8, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x97bb8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x97bd0, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x97bb8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x97c0c, sec_type: 0x12 }, 0x3ac0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x97bb8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x9b6d0, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x97bb8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x9b6f0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0xc2000, ffs_base: 0xc2118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xc2130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0xc2000, ffs_base: 0xc2118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xc2134, sec_type: 0x12 }, 0x40c0),
            ],
        },
        TestCase {
            path: Path::new("../../../3rdparty/fsp/CometLakeFspBinPkg/CometLake2/Fsp.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x134, sec_type: 0x12 }, 0x440),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x1088, sec_type: 0x1b }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x10d4, sec_type: 0x12 }, 0x2200),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x32d8, sec_type: 0x15 }, 0xe),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x32ec, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x3300, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x3318, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x3300, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x3354, sec_type: 0x1 }, 0x18cbd),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1c018, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x1c030, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1c018, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x1c06c, sec_type: 0x1 }, 0x2307),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1e378, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x1e390, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1e378, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x1e3b8, sec_type: 0x1 }, 0x394b),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21d08, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x21d20, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21d08, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x21d5c, sec_type: 0x1 }, 0x2f8),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22058, ffs_guid: GUID(0xd3686f72, 0xb3dc, 0x4bb1, [0x84, 0x7b, 0xfb, 0x8d, 0xdc, 0xda, 0xf7, 0x9c]), ffs_type: 0x6, sec_base: 0x22070, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22058, ffs_guid: GUID(0xd3686f72, 0xb3dc, 0x4bb1, [0x84, 0x7b, 0xfb, 0x8d, 0xdc, 0xda, 0xf7, 0x9c]), ffs_type: 0x6, sec_base: 0x220ac, sec_type: 0x1 }, 0x94e),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22a00, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x22a18, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22a00, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x22a54, sec_type: 0x1 }, 0x128b),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23ce8, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x23d00, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23ce8, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x23d3c, sec_type: 0x1 }, 0x4bb),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24218, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24240, sec_type: 0x12 }, 0x3c0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24604, sec_type: 0x15 }, 0x18),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24620, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24630, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x24648, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24630, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x24670, sec_type: 0x1 }, 0x466),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24ae0, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x24af8, sec_type: 0x1 }, 0x709d),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bba0, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x2bbb8, sec_type: 0x1b }, 0x37),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bba0, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x2bbf4, sec_type: 0x1 }, 0x183),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bd80, ffs_guid: GUID(0xb8ba8298, 0xaf29, 0x4fa3, [0x9d, 0x10, 0x27, 0xa8, 0x47, 0x8b, 0xb6, 0xa7]), ffs_type: 0x7, sec_base: 0x2bd98, sec_type: 0x13 }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bd80, ffs_guid: GUID(0xb8ba8298, 0xaf29, 0x4fa3, [0x9d, 0x10, 0x27, 0xa8, 0x47, 0x8b, 0xb6, 0xa7]), ffs_type: 0x7, sec_base: 0x2bdd4, sec_type: 0x1 }, 0x13d5),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2d1b0, ffs_guid: GUID(0xc92652e3, 0xc7de, 0x4c78, [0x95, 0x77, 0x1c, 0x89, 0x7c, 0x51, 0xbf, 0xfa]), ffs_type: 0x7, sec_base: 0x2d1c8, sec_type: 0x13 }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2d1b0, ffs_guid: GUID(0xc92652e3, 0xc7de, 0x4c78, [0x95, 0x77, 0x1c, 0x89, 0x7c, 0x51, 0xbf, 0xfa]), ffs_type: 0x7, sec_base: 0x2d214, sec_type: 0x1 }, 0x20a6),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2f2c0, ffs_guid: GUID(0x1c652ec8, 0x2347, 0x44c1, [0x93, 0xe0, 0xd1, 0xbe, 0xe8, 0xc8, 0x2f, 0xfc]), ffs_type: 0x7, sec_base: 0x2f2d8, sec_type: 0x13 }, 0x7e),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2f2c0, ffs_guid: GUID(0x1c652ec8, 0x2347, 0x44c1, [0x93, 0xe0, 0xd1, 0xbe, 0xe8, 0xc8, 0x2f, 0xfc]), ffs_type: 0x7, sec_base: 0x2f35c, sec_type: 0x1 }, 0x9de),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x34130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x34134, sec_type: 0x12 }, 0x980),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x34ad0, sec_type: 0x12 }, 0x5860),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x3a334, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x3a348, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a370, sec_type: 0x19 }, 0x128),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a49c, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a4b4, sec_type: 0x12 }, 0x18a0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3bd58, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3bd6c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3bd98, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3bdb0, sec_type: 0x12 }, 0x1140),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3cef4, sec_type: 0x15 }, 0x2a),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3cf24, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3cf50, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3cf68, sec_type: 0x12 }, 0x940),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3d8ac, sec_type: 0x15 }, 0x1e),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3d8d0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3d8f8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3d920, sec_type: 0x12 }, 0x2a0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3dbc4, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3dbe0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3dc08, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3dc30, sec_type: 0x12 }, 0x545c0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x921f4, sec_type: 0x15 }, 0x20),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x92218, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x92228, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x92240, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x92228, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x9227c, sec_type: 0x12 }, 0x3ac0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x92228, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x95d40, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x92228, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x95d60, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0xc2000, ffs_base: 0xc2118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xc2130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0xc2000, ffs_base: 0xc2118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xc2134, sec_type: 0x12 }, 0x40c0),
            ],
        },
        TestCase {
            path: Path::new("../../../3rdparty/fsp/CometLakeFspBinPkg/CometLakeS/Fsp.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x134, sec_type: 0x12 }, 0x440),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x1088, sec_type: 0x1b }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x10d4, sec_type: 0x12 }, 0x2200),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x32d8, sec_type: 0x15 }, 0xe),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x32ec, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x3300, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x3318, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x3300, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x3354, sec_type: 0x1 }, 0x18cbd),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1c018, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x1c030, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1c018, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x1c06c, sec_type: 0x1 }, 0x2307),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1e378, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x1e390, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1e378, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x1e3b8, sec_type: 0x1 }, 0x394b),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21d08, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x21d20, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21d08, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x21d5c, sec_type: 0x1 }, 0x2f8),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22058, ffs_guid: GUID(0xd3686f72, 0xb3dc, 0x4bb1, [0x84, 0x7b, 0xfb, 0x8d, 0xdc, 0xda, 0xf7, 0x9c]), ffs_type: 0x6, sec_base: 0x22070, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22058, ffs_guid: GUID(0xd3686f72, 0xb3dc, 0x4bb1, [0x84, 0x7b, 0xfb, 0x8d, 0xdc, 0xda, 0xf7, 0x9c]), ffs_type: 0x6, sec_base: 0x220ac, sec_type: 0x1 }, 0x94e),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22a00, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x22a18, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22a00, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x22a54, sec_type: 0x1 }, 0x128b),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23ce8, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x23d00, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23ce8, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x23d3c, sec_type: 0x1 }, 0x4bb),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24218, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24240, sec_type: 0x12 }, 0x3c0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24604, sec_type: 0x15 }, 0x18),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24200, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x24620, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24630, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x24648, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24630, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x24670, sec_type: 0x1 }, 0x466),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x24ae0, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x24af8, sec_type: 0x1 }, 0x709d),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bba0, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x2bbb8, sec_type: 0x1b }, 0x37),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bba0, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x2bbf4, sec_type: 0x1 }, 0x183),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bd80, ffs_guid: GUID(0xb8ba8298, 0xaf29, 0x4fa3, [0x9d, 0x10, 0x27, 0xa8, 0x47, 0x8b, 0xb6, 0xa7]), ffs_type: 0x7, sec_base: 0x2bd98, sec_type: 0x13 }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bd80, ffs_guid: GUID(0xb8ba8298, 0xaf29, 0x4fa3, [0x9d, 0x10, 0x27, 0xa8, 0x47, 0x8b, 0xb6, 0xa7]), ffs_type: 0x7, sec_base: 0x2bdd4, sec_type: 0x1 }, 0x13d5),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2d1b0, ffs_guid: GUID(0xc92652e3, 0xc7de, 0x4c78, [0x95, 0x77, 0x1c, 0x89, 0x7c, 0x51, 0xbf, 0xfa]), ffs_type: 0x7, sec_base: 0x2d1c8, sec_type: 0x13 }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2d1b0, ffs_guid: GUID(0xc92652e3, 0xc7de, 0x4c78, [0x95, 0x77, 0x1c, 0x89, 0x7c, 0x51, 0xbf, 0xfa]), ffs_type: 0x7, sec_base: 0x2d214, sec_type: 0x1 }, 0x20a6),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2f2c0, ffs_guid: GUID(0x1c652ec8, 0x2347, 0x44c1, [0x93, 0xe0, 0xd1, 0xbe, 0xe8, 0xc8, 0x2f, 0xfc]), ffs_type: 0x7, sec_base: 0x2f2d8, sec_type: 0x13 }, 0x7e),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2f2c0, ffs_guid: GUID(0x1c652ec8, 0x2347, 0x44c1, [0x93, 0xe0, 0xd1, 0xbe, 0xe8, 0xc8, 0x2f, 0xfc]), ffs_type: 0x7, sec_base: 0x2f35c, sec_type: 0x1 }, 0x9de),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x34130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x34134, sec_type: 0x12 }, 0x980),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x34ad0, sec_type: 0x12 }, 0x5860),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x3a334, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x3a348, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a370, sec_type: 0x19 }, 0x128),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a49c, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a4b4, sec_type: 0x12 }, 0x18a0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3bd58, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3bd6c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3bd98, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3bdb0, sec_type: 0x12 }, 0x1140),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3cef4, sec_type: 0x15 }, 0x2a),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3cf24, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3cf50, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3cf68, sec_type: 0x12 }, 0x940),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3d8ac, sec_type: 0x15 }, 0x1e),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3cf38, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3d8d0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3d8f8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3d920, sec_type: 0x12 }, 0x2a0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3dbc4, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d8e0, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3dbe0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3dc08, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3dc30, sec_type: 0x12 }, 0x59f90),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x97bc4, sec_type: 0x15 }, 0x20),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dbf0, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x97be8, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x97bf8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x97c10, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x97bf8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x97c4c, sec_type: 0x12 }, 0x3ac0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x97bf8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x9b710, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x97bf8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x9b730, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0xc2000, ffs_base: 0xc2118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xc2130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0xc2000, ffs_base: 0xc2118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xc2134, sec_type: 0x12 }, 0x40c0),
            ],
        },
        TestCase {
            path: Path::new("../../../3rdparty/fsp/CometLakeFspBinPkg/CometLakeV/Fsp.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x134, sec_type: 0x12 }, 0x440),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1030, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x1048, sec_type: 0x1b }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1030, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x1094, sec_type: 0x12 }, 0x2200),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1030, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x3298, sec_type: 0x15 }, 0xe),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1030, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x32ac, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x32c0, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x32d8, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x32c0, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x3314, sec_type: 0x1 }, 0x172a6),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1a5c0, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x1a5d8, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1a5c0, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x1a614, sec_type: 0x1 }, 0x20a9),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1c6c8, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x1c6e0, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1c6c8, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x1c708, sec_type: 0x1 }, 0x394c),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x20058, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x20070, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x20058, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x200ac, sec_type: 0x1 }, 0x2f8),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x203a8, ffs_guid: GUID(0xd3686f72, 0xb3dc, 0x4bb1, [0x84, 0x7b, 0xfb, 0x8d, 0xdc, 0xda, 0xf7, 0x9c]), ffs_type: 0x6, sec_base: 0x203c0, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x203a8, ffs_guid: GUID(0xd3686f72, 0xb3dc, 0x4bb1, [0x84, 0x7b, 0xfb, 0x8d, 0xdc, 0xda, 0xf7, 0x9c]), ffs_type: 0x6, sec_base: 0x203fc, sec_type: 0x1 }, 0xc04),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21008, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x21020, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21008, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x2105c, sec_type: 0x1 }, 0x13cf),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22430, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x22448, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22430, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x22484, sec_type: 0x1 }, 0x4bb),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22948, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x22960, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22948, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x22988, sec_type: 0x12 }, 0x3c0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22948, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x22d4c, sec_type: 0x15 }, 0x18),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22948, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x22d68, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22d78, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x22d90, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22d78, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x22db8, sec_type: 0x1 }, 0x466),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23228, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x23240, sec_type: 0x1 }, 0x709d),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2a2e8, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x2a300, sec_type: 0x1b }, 0x37),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2a2e8, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x2a33c, sec_type: 0x1 }, 0x183),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2a4c8, ffs_guid: GUID(0xb8ba8298, 0xaf29, 0x4fa3, [0x9d, 0x10, 0x27, 0xa8, 0x47, 0x8b, 0xb6, 0xa7]), ffs_type: 0x7, sec_base: 0x2a4e0, sec_type: 0x13 }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2a4c8, ffs_guid: GUID(0xb8ba8298, 0xaf29, 0x4fa3, [0x9d, 0x10, 0x27, 0xa8, 0x47, 0x8b, 0xb6, 0xa7]), ffs_type: 0x7, sec_base: 0x2a508, sec_type: 0x1 }, 0x164d),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bb60, ffs_guid: GUID(0xc92652e3, 0xc7de, 0x4c78, [0x95, 0x77, 0x1c, 0x89, 0x7c, 0x51, 0xbf, 0xfa]), ffs_type: 0x7, sec_base: 0x2bb78, sec_type: 0x13 }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2bb60, ffs_guid: GUID(0xc92652e3, 0xc7de, 0x4c78, [0x95, 0x77, 0x1c, 0x89, 0x7c, 0x51, 0xbf, 0xfa]), ffs_type: 0x7, sec_base: 0x2bbc4, sec_type: 0x1 }, 0x274e),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2e318, ffs_guid: GUID(0x1c652ec8, 0x2347, 0x44c1, [0x93, 0xe0, 0xd1, 0xbe, 0xe8, 0xc8, 0x2f, 0xfc]), ffs_type: 0x7, sec_base: 0x2e330, sec_type: 0x13 }, 0x7e),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2e318, ffs_guid: GUID(0x1c652ec8, 0x2347, 0x44c1, [0x93, 0xe0, 0xd1, 0xbe, 0xe8, 0xc8, 0x2f, 0xfc]), ffs_type: 0x7, sec_base: 0x2e3b4, sec_type: 0x1 }, 0x9de),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x34130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x34134, sec_type: 0x12 }, 0x980),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x34ad0, sec_type: 0x12 }, 0x5860),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x3a334, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x34ab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x3a348, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a370, sec_type: 0x19 }, 0x128),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a49c, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3a4b4, sec_type: 0x12 }, 0x18a0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3bd58, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3a358, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3bd6c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3bd98, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3bdb0, sec_type: 0x12 }, 0x1340),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3d0f4, sec_type: 0x15 }, 0x2a),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3bd80, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x3d124, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d138, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3d150, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d138, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3d168, sec_type: 0x12 }, 0x7c0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d138, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3d92c, sec_type: 0x15 }, 0x1e),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d138, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x3d950, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d960, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3d978, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d960, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3d9a0, sec_type: 0x12 }, 0x2a0),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d960, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3dc44, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3d960, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x3dc60, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dc70, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3dc88, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dc70, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x3dcb0, sec_type: 0x12 }, 0x5b068),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dc70, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x98d1c, sec_type: 0x15 }, 0x20),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x3dc70, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x98d40, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x98d50, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x98d68, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x98d50, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x98da4, sec_type: 0x12 }, 0x3a80),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x98d50, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x9c828, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x34000, ffs_base: 0x98d50, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x9c848, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0xc2000, ffs_base: 0xc2118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xc2130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0xc2000, ffs_base: 0xc2118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xc2134, sec_type: 0x12 }, 0x42a0),
            ],
        },
        TestCase {
            path: Path::new("../../../3rdparty/fsp/DenvertonNSFspBinPkg/FspBin/DenvertonNSFsp.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x210, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0x228, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x210, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0x22c, sec_type: 0x12 }, 0xb20),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x2390, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x23a8, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x2390, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x23ac, sec_type: 0x12 }, 0x2690),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x4a40, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x4a58, sec_type: 0x12 }, 0x9a70),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x4a40, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0xe4cc, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x4a40, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0xe4e0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0xe4f0, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0xe508, sec_type: 0x19 }, 0x70),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0xe4f0, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0xe57c, sec_type: 0x1b }, 0x2),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0xe4f0, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0xe584, sec_type: 0x12 }, 0x4070),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0xe4f0, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x125f8, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0xe4f0, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x1260c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x12620, ffs_guid: GUID(0xfde29a56, 0xc197, 0x4ae1, [0xbb, 0x98, 0x79, 0x2b, 0x2f, 0x9, 0x72, 0x5d]), ffs_type: 0x6, sec_base: 0x12638, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x12620, ffs_guid: GUID(0xfde29a56, 0xc197, 0x4ae1, [0xbb, 0x98, 0x79, 0x2b, 0x2f, 0x9, 0x72, 0x5d]), ffs_type: 0x6, sec_base: 0x12650, sec_type: 0x12 }, 0x3710),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x12620, ffs_guid: GUID(0xfde29a56, 0xc197, 0x4ae1, [0xbb, 0x98, 0x79, 0x2b, 0x2f, 0x9, 0x72, 0x5d]), ffs_type: 0x6, sec_base: 0x15d64, sec_type: 0x15 }, 0x18),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x12620, ffs_guid: GUID(0xfde29a56, 0xc197, 0x4ae1, [0xbb, 0x98, 0x79, 0x2b, 0x2f, 0x9, 0x72, 0x5d]), ffs_type: 0x6, sec_base: 0x15d80, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x15d90, ffs_guid: GUID(0x4862aff3, 0x667c, 0x5458, [0xb2, 0x74, 0xa1, 0xc6, 0x2d, 0xf8, 0xba, 0x80]), ffs_type: 0x6, sec_base: 0x15da8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x15d90, ffs_guid: GUID(0x4862aff3, 0x667c, 0x5458, [0xb2, 0x74, 0xa1, 0xc6, 0x2d, 0xf8, 0xba, 0x80]), ffs_type: 0x6, sec_base: 0x15dd0, sec_type: 0x12 }, 0x3650),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x15d90, ffs_guid: GUID(0x4862aff3, 0x667c, 0x5458, [0xb2, 0x74, 0xa1, 0xc6, 0x2d, 0xf8, 0xba, 0x80]), ffs_type: 0x6, sec_base: 0x19424, sec_type: 0x15 }, 0x12),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x15d90, ffs_guid: GUID(0x4862aff3, 0x667c, 0x5458, [0xb2, 0x74, 0xa1, 0xc6, 0x2d, 0xf8, 0xba, 0x80]), ffs_type: 0x6, sec_base: 0x1943c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x19450, ffs_guid: GUID(0x9618c0dc, 0x50a4, 0x496c, [0x99, 0x4f, 0x72, 0x41, 0xf2, 0x82, 0xed, 0x1]), ffs_type: 0x6, sec_base: 0x19468, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x19450, ffs_guid: GUID(0x9618c0dc, 0x50a4, 0x496c, [0x99, 0x4f, 0x72, 0x41, 0xf2, 0x82, 0xed, 0x1]), ffs_type: 0x6, sec_base: 0x19480, sec_type: 0x12 }, 0xd760),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x19450, ffs_guid: GUID(0x9618c0dc, 0x50a4, 0x496c, [0x99, 0x4f, 0x72, 0x41, 0xf2, 0x82, 0xed, 0x1]), ffs_type: 0x6, sec_base: 0x26be4, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x19450, ffs_guid: GUID(0x9618c0dc, 0x50a4, 0x496c, [0x99, 0x4f, 0x72, 0x41, 0xf2, 0x82, 0xed, 0x1]), ffs_type: 0x6, sec_base: 0x26c04, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x26c18, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x26c30, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x26c18, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x26c48, sec_type: 0x12 }, 0xee20),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x26c18, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x35a6c, sec_type: 0x15 }, 0x1a),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x26c18, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x35a8c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x35aa0, ffs_guid: GUID(0xb6a2aff3, 0x767c, 0x5658, [0xc3, 0x7a, 0xd1, 0xc8, 0x2e, 0xf7, 0x65, 0x43]), ffs_type: 0x6, sec_base: 0x35ab8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x35aa0, ffs_guid: GUID(0xb6a2aff3, 0x767c, 0x5658, [0xc3, 0x7a, 0xd1, 0xc8, 0x2e, 0xf7, 0x65, 0x43]), ffs_type: 0x6, sec_base: 0x35ae0, sec_type: 0x12 }, 0x3aa0),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x35aa0, ffs_guid: GUID(0xb6a2aff3, 0x767c, 0x5658, [0xc3, 0x7a, 0xd1, 0xc8, 0x2e, 0xf7, 0x65, 0x43]), ffs_type: 0x6, sec_base: 0x39584, sec_type: 0x15 }, 0xc),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x35aa0, ffs_guid: GUID(0xb6a2aff3, 0x767c, 0x5658, [0xc3, 0x7a, 0xd1, 0xc8, 0x2e, 0xf7, 0x65, 0x43]), ffs_type: 0x6, sec_base: 0x39594, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x395a8, ffs_guid: GUID(0x12c67be1, 0xad2e, 0x4f13, [0xa9, 0x5f, 0x6e, 0xdc, 0x2c, 0x43, 0x92, 0xde]), ffs_type: 0x6, sec_base: 0x395c0, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x395a8, ffs_guid: GUID(0x12c67be1, 0xad2e, 0x4f13, [0xa9, 0x5f, 0x6e, 0xdc, 0x2c, 0x43, 0x92, 0xde]), ffs_type: 0x6, sec_base: 0x395e8, sec_type: 0x12 }, 0x2a28),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x395a8, ffs_guid: GUID(0x12c67be1, 0xad2e, 0x4f13, [0xa9, 0x5f, 0x6e, 0xdc, 0x2c, 0x43, 0x92, 0xde]), ffs_type: 0x6, sec_base: 0x3c014, sec_type: 0x15 }, 0x20),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x395a8, ffs_guid: GUID(0x12c67be1, 0xad2e, 0x4f13, [0xa9, 0x5f, 0x6e, 0xdc, 0x2c, 0x43, 0x92, 0xde]), ffs_type: 0x6, sec_base: 0x3c038, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x3c048, ffs_guid: GUID(0xc162b6e9, 0x923b, 0x4c82, [0xbf, 0x3b, 0xd2, 0x4, 0x8f, 0x67, 0x40, 0x6a]), ffs_type: 0x6, sec_base: 0x3c060, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x3c048, ffs_guid: GUID(0xc162b6e9, 0x923b, 0x4c82, [0xbf, 0x3b, 0xd2, 0x4, 0x8f, 0x67, 0x40, 0x6a]), ffs_type: 0x6, sec_base: 0x3c09c, sec_type: 0x12 }, 0x5290),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x3c048, ffs_guid: GUID(0xc162b6e9, 0x923b, 0x4c82, [0xbf, 0x3b, 0xd2, 0x4, 0x8f, 0x67, 0x40, 0x6a]), ffs_type: 0x6, sec_base: 0x41330, sec_type: 0x15 }, 0xe),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x3c048, ffs_guid: GUID(0xc162b6e9, 0x923b, 0x4c82, [0xbf, 0x3b, 0xd2, 0x4, 0x8f, 0x67, 0x40, 0x6a]), ffs_type: 0x6, sec_base: 0x41344, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x41358, ffs_guid: GUID(0x61820d8f, 0x3506, 0x4071, [0xa0, 0xc5, 0x87, 0xa0, 0x50, 0x24, 0xf9, 0x3]), ffs_type: 0x6, sec_base: 0x41370, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x41358, ffs_guid: GUID(0x61820d8f, 0x3506, 0x4071, [0xa0, 0xc5, 0x87, 0xa0, 0x50, 0x24, 0xf9, 0x3]), ffs_type: 0x6, sec_base: 0x41388, sec_type: 0x12 }, 0x4dd20),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x41358, ffs_guid: GUID(0x61820d8f, 0x3506, 0x4071, [0xa0, 0xc5, 0x87, 0xa0, 0x50, 0x24, 0xf9, 0x3]), ffs_type: 0x6, sec_base: 0x8f0ac, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x2000, ffs_base: 0x41358, ffs_guid: GUID(0x61820d8f, 0x3506, 0x4071, [0xa0, 0xc5, 0x87, 0xa0, 0x50, 0x24, 0xf9, 0x3]), ffs_type: 0x6, sec_base: 0x8f0c8, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0x93290, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x932a8, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0x93290, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x932ac, sec_type: 0x12 }, 0x1c60),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0x94f10, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x94f28, sec_type: 0x1b }, 0x48),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0x94f10, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x94f74, sec_type: 0x12 }, 0x4788),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0x94f10, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x99700, sec_type: 0x15 }, 0xe),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0x94f10, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x99714, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0x99728, ffs_guid: GUID(0x47ea2673, 0x2533, 0x4c07, [0xaa, 0xba, 0x69, 0xce, 0x5a, 0x7c, 0x5d, 0x35]), ffs_type: 0x6, sec_base: 0x99740, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0x99728, ffs_guid: GUID(0x47ea2673, 0x2533, 0x4c07, [0xaa, 0xba, 0x69, 0xce, 0x5a, 0x7c, 0x5d, 0x35]), ffs_type: 0x6, sec_base: 0x99758, sec_type: 0x1 }, 0x1988),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0x9b0e8, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x9b100, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0x9b0e8, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x9b128, sec_type: 0x1 }, 0x8560),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0xa3690, ffs_guid: GUID(0x1b6d919d, 0xde6a, 0x4242, [0x9c, 0xd9, 0x2d, 0xb2, 0xd6, 0x8d, 0x8, 0x2]), ffs_type: 0x6, sec_base: 0xa36a8, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0xa3690, ffs_guid: GUID(0x1b6d919d, 0xde6a, 0x4242, [0x9c, 0xd9, 0x2d, 0xb2, 0xd6, 0x8d, 0x8, 0x2]), ffs_type: 0x6, sec_base: 0xa36c0, sec_type: 0x1 }, 0x163e),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0xa4d08, ffs_guid: GUID(0xea74e953, 0x19a, 0x44ec, [0xa3, 0xa2, 0xf0, 0x15, 0xf, 0xf7, 0xc8, 0x75]), ffs_type: 0x6, sec_base: 0xa4d20, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0xa4d08, ffs_guid: GUID(0xea74e953, 0x19a, 0x44ec, [0xa3, 0xa2, 0xf0, 0x15, 0xf, 0xf7, 0xc8, 0x75]), ffs_type: 0x6, sec_base: 0xa4d38, sec_type: 0x1 }, 0x2495),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0xa71d8, ffs_guid: GUID(0x4d1f48d8, 0x498, 0x4c09, [0x8e, 0xde, 0x72, 0xf3, 0xb, 0x58, 0xb1, 0xf2]), ffs_type: 0x6, sec_base: 0xa71f0, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0xa71d8, ffs_guid: GUID(0x4d1f48d8, 0x498, 0x4c09, [0x8e, 0xde, 0x72, 0xf3, 0xb, 0x58, 0xb1, 0xf2]), ffs_type: 0x6, sec_base: 0xa7208, sec_type: 0x1 }, 0x1f64),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0xa9170, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0xa9188, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x93000, ffs_base: 0xa9170, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0xa91b0, sec_type: 0x1 }, 0x15bb),
            ],
        },
        TestCase {
            path: Path::new("../../../3rdparty/fsp/IceLakeFspBinPkg/Fsp.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x118, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x134, sec_type: 0x12 }, 0x440),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x1088, sec_type: 0x1b }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x10d4, sec_type: 0x12 }, 0x1e40),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x2f18, sec_type: 0x15 }, 0xe),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1070, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x2f2c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2f40, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x2f58, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2f40, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x2f80, sec_type: 0x1 }, 0x2afd),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x5a88, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x5aa0, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x5a88, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x5ac8, sec_type: 0x12 }, 0x3c0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x5a88, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x5e8c, sec_type: 0x15 }, 0x18),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x5a88, ffs_guid: GUID(0xea7f0916, 0xb5c8, 0x493f, [0xa0, 0x6, 0x56, 0x5c, 0xc2, 0x4, 0x10, 0x44]), ffs_type: 0x6, sec_base: 0x5ea8, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x5eb8, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x5ed0, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x5eb8, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0x5f0c, sec_type: 0x1 }, 0x3641),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x9558, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x9570, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x9558, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x95ac, sec_type: 0x1 }, 0x1a582),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23b38, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x23b50, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23b38, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x23b78, sec_type: 0x1 }, 0x337),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23eb8, ffs_guid: GUID(0xd3686f72, 0xb3dc, 0x4bb1, [0x84, 0x7b, 0xfb, 0x8d, 0xdc, 0xda, 0xf7, 0x9c]), ffs_type: 0x6, sec_base: 0x23ed0, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23eb8, ffs_guid: GUID(0xd3686f72, 0xb3dc, 0x4bb1, [0x84, 0x7b, 0xfb, 0x8d, 0xdc, 0xda, 0xf7, 0x9c]), ffs_type: 0x6, sec_base: 0x23ef8, sec_type: 0x1 }, 0x9cf),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x248d0, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x248e8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x248d0, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x24910, sec_type: 0x1 }, 0xf4b),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x25860, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x25878, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x25860, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x258a0, sec_type: 0x1 }, 0x447),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x25cf0, ffs_guid: GUID(0xb8ba8298, 0xaf29, 0x4fa3, [0x9d, 0x10, 0x27, 0xa8, 0x47, 0x8b, 0xb6, 0xa7]), ffs_type: 0x7, sec_base: 0x25d08, sec_type: 0x13 }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x25cf0, ffs_guid: GUID(0xb8ba8298, 0xaf29, 0x4fa3, [0x9d, 0x10, 0x27, 0xa8, 0x47, 0x8b, 0xb6, 0xa7]), ffs_type: 0x7, sec_base: 0x25d44, sec_type: 0x1 }, 0x140b),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x27158, ffs_guid: GUID(0xc92652e3, 0xc7de, 0x4c78, [0x95, 0x77, 0x1c, 0x89, 0x7c, 0x51, 0xbf, 0xfa]), ffs_type: 0x7, sec_base: 0x27170, sec_type: 0x13 }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x27158, ffs_guid: GUID(0xc92652e3, 0xc7de, 0x4c78, [0x95, 0x77, 0x1c, 0x89, 0x7c, 0x51, 0xbf, 0xfa]), ffs_type: 0x7, sec_base: 0x271bc, sec_type: 0x1 }, 0x1e97),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x29058, ffs_guid: GUID(0x1c652ec8, 0x2347, 0x44c1, [0x93, 0xe0, 0xd1, 0xbe, 0xe8, 0xc8, 0x2f, 0xfc]), ffs_type: 0x7, sec_base: 0x29070, sec_type: 0x13 }, 0x7e),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x29058, ffs_guid: GUID(0x1c652ec8, 0x2347, 0x44c1, [0x93, 0xe0, 0xd1, 0xbe, 0xe8, 0xc8, 0x2f, 0xfc]), ffs_type: 0x7, sec_base: 0x290f4, sec_type: 0x1 }, 0x411),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x29510, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x29528, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x29510, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x29550, sec_type: 0x1 }, 0x466),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x299c0, ffs_guid: GUID(0xc0d99356, 0x63ae, 0x4034, [0xa0, 0x51, 0x74, 0xb3, 0xe8, 0xb, 0xc, 0x4d]), ffs_type: 0x6, sec_base: 0x299d8, sec_type: 0x1 }, 0xc994),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x36370, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x36388, sec_type: 0x1 }, 0xc98d),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x42d20, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x42d38, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x42d20, ffs_guid: GUID(0x8b555ae2, 0x4254, 0x43a2, [0x83, 0x9e, 0x48, 0x69, 0x60, 0x4c, 0xcc, 0x9a]), ffs_type: 0x6, sec_base: 0x42d60, sec_type: 0x1 }, 0x183),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x4c118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x4c130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x4c118, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x4c134, sec_type: 0x12 }, 0x980),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x4cab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x4cad0, sec_type: 0x12 }, 0x5480),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x4cab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x51f54, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x4cab8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x51f68, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x51f78, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x51f90, sec_type: 0x19 }, 0x118),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x51f78, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x520ac, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x51f78, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x520c4, sec_type: 0x12 }, 0x1740),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x51f78, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x53808, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x51f78, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x5381c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x53830, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x53848, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x53830, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x53870, sec_type: 0x12 }, 0x720),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x53830, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x53f94, sec_type: 0x15 }, 0x1e),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x53830, ffs_guid: GUID(0x6141e486, 0x7543, 0x4f1a, [0xa5, 0x79, 0xff, 0x53, 0x2e, 0xd7, 0x8e, 0x75]), ffs_type: 0x6, sec_base: 0x53fb8, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x53fc8, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x53fe0, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x53fc8, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x53ff8, sec_type: 0x12 }, 0x10c0),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x53fc8, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x550bc, sec_type: 0x15 }, 0x2a),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x53fc8, ffs_guid: GUID(0xbaeb5bee, 0x5b33, 0x480a, [0x8a, 0xb7, 0xb2, 0x9c, 0x85, 0xe7, 0xce, 0xab]), ffs_type: 0x6, sec_base: 0x550ec, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x55100, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x55118, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x55100, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x55140, sec_type: 0x12 }, 0x2e0),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x55100, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x55424, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x55100, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x55440, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x55450, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x55468, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x55450, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x55480, sec_type: 0x12 }, 0x5cf68),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x55450, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0xb23ec, sec_type: 0x15 }, 0x20),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0x55450, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0xb2410, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0xb2420, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0xb2438, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0xb2420, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0xb2460, sec_type: 0x12 }, 0x5060),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0xb2420, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0xb74c4, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x4c000, ffs_base: 0xb2420, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0xb74e4, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0xd5000, ffs_base: 0xd5118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xd5130, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0xd5000, ffs_base: 0xd5118, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0xd5134, sec_type: 0x12 }, 0x5540),
            ],
        },
        TestCase {
            path: Path::new("../../../3rdparty/fsp/KabylakeFspBinPkg/Fsp.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x100, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x118, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x100, ffs_guid: GUID(0x53ab1acd, 0xedb1, 0x4e3a, [0xa2, 0xc7, 0x97, 0x8d, 0x72, 0x1d, 0x17, 0x9d]), ffs_type: 0x3, sec_base: 0x11c, sec_type: 0x12 }, 0x440),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x560, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x578, sec_type: 0x1b }, 0x48),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x560, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x5c4, sec_type: 0x12 }, 0x19e0),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x560, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x1fa8, sec_type: 0x15 }, 0xe),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x560, ffs_guid: GUID(0x86d70125, 0xbaa3, 0x4296, [0xa6, 0x2f, 0x60, 0x2b, 0xeb, 0xbb, 0x90, 0x81]), ffs_type: 0x6, sec_base: 0x1fbc, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1fd0, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x1fe8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x1fd0, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x2010, sec_type: 0x1 }, 0x2f94),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x4fa8, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x4fc0, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x4fa8, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x4fd8, sec_type: 0x1 }, 0x478),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x5458, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x5470, sec_type: 0x1 }, 0x6f16),
                (SectionInfo { fv_base: 0x0, ffs_base: 0xc390, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0xc3a8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0xc390, ffs_guid: GUID(0xedadeb9d, 0xddba, 0x48bd, [0x9d, 0x22, 0xc1, 0xc1, 0x69, 0xc8, 0xc5, 0xc6]), ffs_type: 0x6, sec_base: 0xc3d0, sec_type: 0x1 }, 0x1973),
                (SectionInfo { fv_base: 0x0, ffs_base: 0xdd48, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0xdd60, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0xdd48, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0xdd9c, sec_type: 0x1 }, 0x13d2d),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21ad0, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x21ae8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21ad0, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x21b10, sec_type: 0x1 }, 0x2ef),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21e08, ffs_guid: GUID(0x5aa5031e, 0x4cb6, 0x43d4, [0xb2, 0x19, 0xfe, 0x50, 0xff, 0x5d, 0x11, 0x6c]), ffs_type: 0x6, sec_base: 0x21e20, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x21e08, ffs_guid: GUID(0x5aa5031e, 0x4cb6, 0x43d4, [0xb2, 0x19, 0xfe, 0x50, 0xff, 0x5d, 0x11, 0x6c]), ffs_type: 0x6, sec_base: 0x21e48, sec_type: 0x1 }, 0xc02),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22a50, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x22a68, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x22a50, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x22a90, sec_type: 0x1 }, 0x1398),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23e30, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x23e48, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x23e30, ffs_guid: GUID(0x29cbb005, 0xc972, 0x49f3, [0x96, 0xf, 0x29, 0x2e, 0x22, 0x2, 0xce, 0xcd]), ffs_type: 0x6, sec_base: 0x23e70, sec_type: 0x1 }, 0x434),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x2e100, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x2e118, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x2e100, ffs_guid: GUID(0xc2f9ae46, 0x3437, 0x4fef, [0x9c, 0xb1, 0x9a, 0x56, 0x8b, 0x28, 0x2f, 0xee]), ffs_type: 0x3, sec_base: 0x2e11c, sec_type: 0x12 }, 0x8c8),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x2e9e8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x2ea00, sec_type: 0x12 }, 0x4c40),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x2e9e8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x33644, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x2e9e8, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x33658, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x33668, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x33680, sec_type: 0x19 }, 0x90),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x33668, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x33714, sec_type: 0x1b }, 0x2),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x33668, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x3371c, sec_type: 0x12 }, 0x14e0),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x33668, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x34c00, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x33668, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x34c14, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34c28, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x34c40, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34c28, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x34c68, sec_type: 0x12 }, 0x280),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34c28, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x34eec, sec_type: 0x15 }, 0x16),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34c28, ffs_guid: GUID(0x88c17e54, 0xebfe, 0x4531, [0xa9, 0x92, 0x58, 0x10, 0x29, 0xf5, 0x81, 0x26]), ffs_type: 0x6, sec_base: 0x34f08, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34f18, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x34f30, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34f18, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x34f48, sec_type: 0x12 }, 0x522c8),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34f18, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x87214, sec_type: 0x15 }, 0x20),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x34f18, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x87238, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x87248, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x87260, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x87248, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x87278, sec_type: 0x12 }, 0x6090),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x87248, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x8d30c, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x2e000, ffs_base: 0x87248, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x8d32c, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x91000, ffs_base: 0x91100, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0x91118, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x91000, ffs_base: 0x91100, ffs_guid: GUID(0x5b94e419, 0xc795, 0x414d, [0xa0, 0xd4, 0xb8, 0xa, 0x87, 0x7b, 0xe5, 0xfe]), ffs_type: 0x3, sec_base: 0x9111c, sec_type: 0x12 }, 0x21e8),
            ],
        },
        TestCase {
            path: Path::new("../../../3rdparty/fsp/SkylakeFspBinPkg/FspBin/SkylakeFsp.fd"),
            expected_sections_and_sizes: &[
                (SectionInfo { fv_base: 0x0, ffs_base: 0x108, ffs_guid: GUID(0x98c8588c, 0x640a, 0x4bb4, [0xae, 0xa0, 0x3f, 0x81, 0xcd, 0xe1, 0x75, 0x24]), ffs_type: 0x6, sec_base: 0x120, sec_type: 0x1b }, 0x36),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x108, ffs_guid: GUID(0x98c8588c, 0x640a, 0x4bb4, [0xae, 0xa0, 0x3f, 0x81, 0xcd, 0xe1, 0x75, 0x24]), ffs_type: 0x6, sec_base: 0x15c, sec_type: 0x12 }, 0x1148),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x108, ffs_guid: GUID(0x98c8588c, 0x640a, 0x4bb4, [0xae, 0xa0, 0x3f, 0x81, 0xcd, 0xe1, 0x75, 0x24]), ffs_type: 0x6, sec_base: 0x12a8, sec_type: 0x15 }, 0x14),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x108, ffs_guid: GUID(0x98c8588c, 0x640a, 0x4bb4, [0xae, 0xa0, 0x3f, 0x81, 0xcd, 0xe1, 0x75, 0x24]), ffs_type: 0x6, sec_base: 0x12c0, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x12d0, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x12e8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x12d0, ffs_guid: GUID(0x131b73ac, 0xc033, 0x4de1, [0x87, 0x94, 0x6d, 0xab, 0x8, 0xe7, 0x31, 0xcf]), ffs_type: 0x6, sec_base: 0x1310, sec_type: 0x1 }, 0x106f),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2388, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x23a0, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2388, ffs_guid: GUID(0x4f1f379f, 0x2a62, 0x48bb, [0xac, 0x34, 0xd3, 0xf1, 0x35, 0xc6, 0xe2, 0xb7]), ffs_type: 0x6, sec_base: 0x23b8, sec_type: 0x1 }, 0x46c),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2828, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x2840, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x2828, ffs_guid: GUID(0x76ed893a, 0xb2f9, 0x4c7d, [0xa0, 0x5f, 0x1e, 0xa1, 0x70, 0xec, 0xf6, 0xcd]), ffs_type: 0x6, sec_base: 0x2858, sec_type: 0x1 }, 0x5e11),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x8670, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x8688, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x8670, ffs_guid: GUID(0x299d6f8b, 0x2ec9, 0x4e40, [0x9e, 0xc6, 0xdd, 0xaa, 0x7e, 0xbf, 0x5f, 0xd9]), ffs_type: 0x6, sec_base: 0x86b0, sec_type: 0x1 }, 0xf007),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x176c0, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x176d8, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x176c0, ffs_guid: GUID(0x4e22bf36, 0xc59d, 0x47c4, [0x9f, 0xd1, 0x25, 0xa6, 0x3, 0xd7, 0x59, 0x58]), ffs_type: 0x6, sec_base: 0x17700, sec_type: 0x1 }, 0x254),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x17958, ffs_guid: GUID(0x5aa5031e, 0x4cb6, 0x43d4, [0xb2, 0x19, 0xfe, 0x50, 0xff, 0x5d, 0x11, 0x6c]), ffs_type: 0x6, sec_base: 0x17970, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x17958, ffs_guid: GUID(0x5aa5031e, 0x4cb6, 0x43d4, [0xb2, 0x19, 0xfe, 0x50, 0xff, 0x5d, 0x11, 0x6c]), ffs_type: 0x6, sec_base: 0x17998, sec_type: 0x1 }, 0x144d),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x18df0, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x18e08, sec_type: 0x1b }, 0x24),
                (SectionInfo { fv_base: 0x0, ffs_base: 0x18df0, ffs_guid: GUID(0xeee8d8ec, 0x40c2, 0x159b, [0x71, 0xc7, 0x87, 0x96, 0xee, 0xef, 0x3f, 0xbc]), ffs_type: 0x6, sec_base: 0x18e30, sec_type: 0x1 }, 0xe83),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x1c078, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x1c090, sec_type: 0x12 }, 0x49d0),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x1c078, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x20a64, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x1c078, ffs_guid: GUID(0x52c05b14, 0xb98, 0x496c, [0xbc, 0x3b, 0x4, 0xb5, 0x2, 0x11, 0xd6, 0x80]), ffs_type: 0x4, sec_base: 0x20a78, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x20a88, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x20aa0, sec_type: 0x19 }, 0x77),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x20a88, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x20b1c, sec_type: 0x1b }, 0x2),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x20a88, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x20b24, sec_type: 0x12 }, 0x1368),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x20a88, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x21e90, sec_type: 0x15 }, 0x10),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x20a88, ffs_guid: GUID(0x9b3ada4f, 0xae56, 0x4c24, [0x8d, 0xea, 0xf0, 0x3b, 0x75, 0x58, 0xae, 0x50]), ffs_type: 0x6, sec_base: 0x21ea4, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x22310, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x22328, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x22310, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x22340, sec_type: 0x12 }, 0x42450),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x22310, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x64794, sec_type: 0x15 }, 0x20),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x22310, ffs_guid: GUID(0xa8499e65, 0xa6f6, 0x48b0, [0x96, 0xdb, 0x45, 0xc2, 0x66, 0x3, 0xd, 0x83]), ffs_type: 0x6, sec_base: 0x647b8, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x647c8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x647e0, sec_type: 0x1b }, 0x12),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x647c8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x647f8, sec_type: 0x12 }, 0x3c58),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x647c8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x68454, sec_type: 0x15 }, 0x1c),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x647c8, ffs_guid: GUID(0x9e1cc850, 0x6731, 0x4848, [0x87, 0x52, 0x66, 0x73, 0xc7, 0x0, 0x5e, 0xee]), ffs_type: 0x6, sec_base: 0x68474, sec_type: 0x14 }, 0xa),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x73828, ffs_guid: GUID(0x1ba0062e, 0xc779, 0x4582, [0x85, 0x66, 0x33, 0x6a, 0xe8, 0xf7, 0x8f, 0x9]), ffs_type: 0x3, sec_base: 0x73840, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x73828, ffs_guid: GUID(0x1ba0062e, 0xc779, 0x4582, [0x85, 0x66, 0x33, 0x6a, 0xe8, 0xf7, 0x8f, 0x9]), ffs_type: 0x3, sec_base: 0x73844, sec_type: 0x12 }, 0x2770),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x73828, ffs_guid: GUID(0x1ba0062e, 0xc779, 0x4582, [0x85, 0x66, 0x33, 0x6a, 0xe8, 0xf7, 0x8f, 0x9]), ffs_type: 0x3, sec_base: 0x75fb8, sec_type: 0x19 }, 0x0),
                (SectionInfo { fv_base: 0x1c000, ffs_base: 0x73828, ffs_guid: GUID(0x1ba0062e, 0xc779, 0x4582, [0x85, 0x66, 0x33, 0x6a, 0xe8, 0xf7, 0x8f, 0x9]), ffs_type: 0x3, sec_base: 0x75fbc, sec_type: 0x19 }, 0x40),
            ],
        },
    ];

    for &TestCase { path, expected_sections_and_sizes } in test_cases {
        let fv = fs::read(path)?;

        let mut sections_and_sizes = Vec::new();
        let result = fv_traverse(&fv, &mut |sec_info, sec_data: SectionData| sections_and_sizes.push((sec_info, sec_data.len())));
        if let Err(err) = result {
            assert!(false, "failed to parse {}: {}", path.display(), err);
        }

        assert_eq!(sections_and_sizes, expected_sections_and_sizes, "for {}, got:\n{:#x?}\nexpected:\n{:#x?}", path.display(), sections_and_sizes, expected_sections_and_sizes);
    }

    Ok(())
}
